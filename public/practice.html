<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>å•è¯å™©æ¢¦ - è‡ªç”±ç»ƒä¹ </title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">

  <h1 class="text-3xl font-bold text-purple-600 mb-6">ğŸ¯ è‡ªç”±ç»ƒä¹ </h1>

  <div id="card" class="bg-white shadow rounded p-6 w-full max-w-lg text-center">
    <p id="question" class="text-xl mb-4">ç‚¹å‡»å¼€å§‹ç»ƒä¹ ï¼</p>
    <input id="answerInput" type="text" placeholder="è¾“å…¥ç­”æ¡ˆ"
           class="border px-3 py-2 rounded w-2/3 mb-3" />
    <div class="space-x-2">
      <button onclick="checkAnswer()" class="px-4 py-2 bg-blue-500 text-white rounded">æäº¤</button>
      <button onclick="nextWord()" class="px-4 py-2 bg-gray-500 text-white rounded">ä¸‹ä¸€é¢˜</button>
      <a href="index.html" class="px-4 py-2 bg-green-500 text-white rounded">è¿”å›é¦–é¡µ</a>
    </div>
    <p id="feedback" class="mt-4 text-gray-700"></p>
  </div>

  <script>
  let words = [];
  let currentWord = null;
  let mode = "en-zh"; // é»˜è®¤è‹±è¯‘ä¸­

  async function loadWords() {
    try {
      let res = await fetch("words.json");
      words = await res.json();
      words = words.flatMap(group => group.words); // æ‰“å¹³æˆä¸€ä¸ªå¤§æ•°ç»„
      nextWord();
    } catch (err) {
      console.error(err);
      document.getElementById("question").innerText = "åŠ è½½å•è¯å¤±è´¥";
    }
  }

  function nextWord() {
    if (words.length === 0) return;
    currentWord = words[Math.floor(Math.random() * words.length)];
    // éšæœºå†³å®šç»ƒä¹ æ–¹å‘
    mode = Math.random() > 0.5 ? "en-zh" : "zh-en";

    if (mode === "en-zh") {
      document.getElementById("question").innerText = `è¯·ç¿»è¯‘æˆä¸­æ–‡: ${currentWord.en}`;
    } else {
      document.getElementById("question").innerText = `è¯·ç¿»è¯‘æˆè‹±æ–‡: ${currentWord.zh}`;
    }

    document.getElementById("answerInput").value = "";
    document.getElementById("feedback").innerText = "";
  }

  function checkAnswer() {
    let userAns = document.getElementById("answerInput").value.trim();
    let correctAns = mode === "en-zh" ? currentWord.zh : currentWord.en;

    if (userAns === correctAns) {
      document.getElementById("feedback").innerHTML =
        `<span class="text-green-600">âœ… æ­£ç¡®ï¼</span>`;
    } else {
      document.getElementById("feedback").innerHTML =
        `<span class="text-red-600">âŒ é”™è¯¯ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯: ${correctAns}</span>`;
      saveWrong(currentWord, mode);
    }
  }

  function saveWrong(word, mode) {
    let wrongList = JSON.parse(localStorage.getItem("wrongWords") || "[]");
    wrongList.push({ ...word, mode });
    localStorage.setItem("wrongWords", JSON.stringify(wrongList));
  }

  loadWords();
  </script>
</body>
</html>
